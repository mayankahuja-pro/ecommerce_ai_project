{% extends 'store/base.html' %}
{% block content %}

<h2 class="mb-4 fw-bold">Explore Our Products</h2>
<div class="row g-4">
{% for product in products %}
  <div class="col-md-4 col-lg-3">
    <div class="card h-100 shadow-sm border-0">
      <div class="position-relative">
        {% if "http" in product.image.name %}
            <img src="{{ product.image.name }}" class="card-img-top" alt="{{ product.name }}">
        {% else %}
            <img src="{{ product.image.url }}" class="card-img-top" alt="{{ product.name }}">
        {% endif %}
        <div class="position-absolute top-0 end-0 p-3">
            <a href="/like/{{ product.id }}/" class="btn-like {% if product.id in liked_product_ids %}active{% endif %}">
                {% if product.id in liked_product_ids %}‚ù§Ô∏è{% else %}ü§ç{% endif %}
            </a>
        </div>
      </div>
      <div class="card-body d-flex flex-column">
        <span class="badge-category mb-2 d-inline-block">{{ product.category }}</span>
        <h5 class="card-title fw-bold mb-1">{{ product.name }}</h5>
        <p class="card-text text-muted small mb-3">{{ product.description|truncatechars:80 }}</p>
        <div class="mt-auto d-flex justify-content-between align-items-center">
            <span class="price-tag">‚Çπ{{ product.price }}</span>
            <a href="/add-to-cart/{{ product.id }}/" class="btn btn-primary btn-sm px-3">Add to Cart</a>
        </div>
      </div>
    </div>
  </div>
{% endfor %}
</div>

{% if recommendations %}
<div class="mt-5 pt-5 border-top">
    <h3 class="mb-4 fw-bold">‚ú® Especially Curated for You</h3>
    <div class="row g-4">
    {% for product in recommendations %}
    <div class="col-md-3">
        <div class="card h-100 border-0 shadow-sm" style="background: #fff;">
        <div class="position-relative">
            {% if "http" in product.image.name %}
                <img src="{{ product.image.name }}" class="card-img-top" alt="{{ product.name }}" style="height: 150px;">
            {% else %}
                <img src="{{ product.image.url }}" class="card-img-top" alt="{{ product.name }}" style="height: 150px;">
            {% endif %}
            <div class="position-absolute top-0 end-0 p-2">
                <a href="/like/{{ product.id }}/" class="btn-like btn-sm {% if product.id in liked_product_ids %}active{% endif %}" style="width: 32px; height: 32px; font-size: 0.9rem;">
                    {% if product.id in liked_product_ids %}‚ù§Ô∏è{% else %}ü§ç{% endif %}
                </a>
            </div>
        </div>
        <div class="card-body p-3">
            <h6 class="fw-bold mb-1">{{ product.name }}</h6>
            <div class="d-flex justify-content-between align-items-center">
                <span class="fw-bold text-accent">‚Çπ{{ product.price }}</span>
                <a href="/add-to-cart/{{ product.id }}/" class="btn btn-dark btn-sm rounded-pill">Add</a>
            </div>
        </div>
        </div>
    </div>
    {% endfor %}
    </div>
</div>
{% endif %}

{% endblock %}

